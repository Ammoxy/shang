(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-471ed41a"],{"302e":function(e,t,a){},bb4a:function(e,t,a){"use strict";a("302e")},ca1e:function(e,t,a){"use strict";a.r(t);var n,l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中"}},[a("div",{staticClass:"handle-box"},[a("div",{staticClass:"btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addMerchants}},[e._v("添加商品")])],1),a("div",{staticClass:"btn"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入商品名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(e.keyword)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.search(e.keyword)}},slot:"append"})],1)],1)]),a("el-dialog",{attrs:{visible:e.dialogMerchants,title:"添加商品",width:"1000px"},on:{"update:visible":function(t){e.dialogMerchants=t},close:e.close}},[a("el-form",{attrs:{"label-width":"80px",model:e.merchantInfo}},[a("el-form-item",{attrs:{label:"选择商家"}},[a("el-select",{attrs:{placeholder:"请选择商家"},on:{change:e.merchantChange},model:{value:e.merchantInfo.merchant_id,callback:function(t){e.$set(e.merchantInfo,"merchant_id",t)},expression:"merchantInfo.merchant_id"}},e._l(e.merchantList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"是否上架"}},[a("el-select",{attrs:{placeholder:"请选择状态"},on:{change:e.stateChange},model:{value:e.merchantInfo.on_shelf,callback:function(t){e.$set(e.merchantInfo,"on_shelf",t)},expression:"merchantInfo.on_shelf"}},e._l(e.stateList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"总价格"}},[a("el-input",{model:{value:e.merchantInfo.total_price,callback:function(t){e.$set(e.merchantInfo,"total_price",t)},expression:"merchantInfo.total_price"}})],1),a("el-form-item",{attrs:{label:"优惠价"}},[a("el-input",{model:{value:e.merchantInfo.reduced_price,callback:function(t){e.$set(e.merchantInfo,"reduced_price",t)},expression:"merchantInfo.reduced_price"}})],1),a("el-form-item",{attrs:{label:"商品库存"}},[a("el-input",{model:{value:e.merchantInfo.repertory,callback:function(t){e.$set(e.merchantInfo,"repertory",t)},expression:"merchantInfo.repertory"}})],1),a("el-form-item",{attrs:{label:"商品销量"}},[a("el-input",{model:{value:e.merchantInfo.sales,callback:function(t){e.$set(e.merchantInfo,"sales",t)},expression:"merchantInfo.sales"}})],1),a("el-form-item",{attrs:{label:"商品名称"}},[a("el-input",{model:{value:e.merchantInfo.name,callback:function(t){e.$set(e.merchantInfo,"name",t)},expression:"merchantInfo.name"}})],1),a("el-form-item",{attrs:{label:"商品简介"}},[a("el-input",{model:{value:e.merchantInfo.intro,callback:function(t){e.$set(e.merchantInfo,"intro",t)},expression:"merchantInfo.intro"}})],1),a("el-form-item",{attrs:{label:"商品图片"}},[a("el-upload",{ref:"upload",attrs:{action:"https://api.fengniaotuangou.cn/api/upload",limit:1,"before-upload":e.beforeAvatarUpload,"on-success":e.handleAvatarSuccess,"on-remove":e.handleRemove,"file-list":e.files,"on-exceed":e.handleExceed,"list-type":"picture-card","on-change":e.handleChange,"auto-upload":!0}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),a("el-form-item",{attrs:{label:"批量上传详情图片"}},[a("el-upload",{ref:"upload",attrs:{action:"https://api.fengniaotuangou.cn/api/upload",limit:9,"before-upload":e.beforeAvatarUpload1,"on-remove":e.handleRemove1,"on-exceed":e.handleExceed1,"auto-upload":!0,"on-change":e.handleChange1,multiple:"","list-type":"picture-card","file-list":e.fileLists,"on-success":e.handleAvatarSuccess1}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),a("el-form-item",{attrs:{label:"商品详情"}},[a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"430px",margin:"0 0 60px 0"},attrs:{options:e.editorOption},model:{value:e.merchantInfo.detail,callback:function(t){e.$set(e.merchantInfo,"detail",t)},expression:"merchantInfo.detail"}}),a("el-upload",{staticClass:"avatar-uploader quill-img",staticStyle:{display:"none"},attrs:{action:"https://api.fengniaotuangou.cn/api/upload","before-upload":e.beforeUpload,"on-success":e.quillImgSuccess}},[a("el-button",{attrs:{size:"small",type:"primary",id:"imgInput","element-loading-text":"插入中,请稍候"}},[e._v("点击上传 ")])],1)],1),a("div",{staticClass:"submit"},[a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.newMerchants}},[e._v("提交")])],1)],1)],1)],1),a("el-table",{attrs:{data:e.tableData,"empty-text":"暂无数据",border:"","header-cell-style":{background:"#f5f7fa"},"max-height":"620"}},[a("el-table-column",{attrs:{prop:"id",label:"商品ID",width:"70"}}),a("el-table-column",{attrs:{prop:"merchant",label:"商家名称"}}),a("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"img",label:"商家logo"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{staticStyle:{"max-width":"180px","max-height":"80px"},attrs:{src:e.row.img}})]}}])}),a("el-table-column",{attrs:{prop:"total_price",label:"商品总价格",width:"70"}}),a("el-table-column",{attrs:{prop:"reduced_price",label:"商品优惠价",width:"70"}}),a("el-table-column",{attrs:{prop:"on_shelf",label:"是否上架",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.on_shelf?a("div",[a("span",[e._v("是")])]):e._e(),2==t.row.on_shelf?a("div",[a("span",[e._v("否")])]):e._e()]}}])}),a("el-table-column",{attrs:{prop:"repertory",label:"库存",width:"70"}}),a("el-table-column",{attrs:{prop:"sales",label:"销量",width:"70"}}),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间"}}),a("el-table-column",{attrs:{label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.handleDetail(t.$index,t.row)}}})]}}])})],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[10,20,30,40,50],"page-size":e.size,layout:"sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.currentChange,"update:currentPage":function(t){e.current=t},"update:current-page":function(t){e.current=t},"size-change":e.sizeChange}})],1)],1)},o=[],i=(a("4160"),a("c975"),a("d81d"),a("a434"),a("b0c0"),a("ac1f"),a("1276"),a("159b"),a("365c")),r=(a("3022"),a("8d81"),a("953d")),s=(a("a7539"),a("8096"),a("14e1"),{inject:["reload"],components:{quillEditor:r["quillEditor"]},data:function(){return{loading:!0,tableData:[],current:1,size:10,total:0,id:"",dialogDel:!1,dialogMerchants:!1,editorOption:{placeholder:"请输入文档内容",theme:"snow",modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote","code-block"],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]],handlers:{image:function(e){e?document.querySelector(".quill-img input").click():this.quill.format("image",!1)}}}}},merchantInfo:{merchant_id:"",name:"",intro:"",detail:"",img:"",imgs:[],total_price:"",reduced_price:"",on_shelf:"",repertory:"",id:"",sales:0},merchantList:[],name:"",stateList:[{value:1,label:"是"},{value:2,label:"否"}],state:"",keyword:"",fileLists:[],files:[]}},mounted:function(){this.getList(),this.getMerList()},methods:{getMerList:function(){var e=this;i["a"].merchants(1,100).then((function(t){e.merchantList=t.data}))},getList:function(){var e=this;i["a"].goods(e.current,e.size).then((function(t){e.loading=!1,e.tableData=t.data,e.total=t.total})).catch((function(t){e.loading=!1}))},search:function(){var e=this;i["a"].goods(e.current,e.size,e.keyword).then((function(t){e.loading=!1,e.tableData=t.data,e.total=t.total})).catch((function(t){e.loading=!1}))},currentChange:function(e){var t=this;t.current=e,t.loading=!0,t.name?i["a"].goods(e,t.size,t.keyword).then((function(e){t.loading=!1,t.tableData=e.data,t.total=e.total})).catch((function(e){t.loading=!1})):i["a"].goods(e,t.size).then((function(e){t.loading=!1,t.tableData=e.data,t.total=e.total})).catch((function(e){t.loading=!1}))},sizeChange:function(e){var t=this;t.size=e,t.loading=!0,t.name?i["a"].goods(t.current,e,t.keyword).then((function(e){t.loading=!1,t.tableData=e.data,t.total=e.total})).catch((function(e){t.loading=!1})):i["a"].goods(t.current,e).then((function(e){t.loading=!1,t.tableData=e.data,t.total=e.total})).catch((function(e){t.loading=!1}))},addMerchants:function(){var e=this;e.dialogMerchants=!0,e.merchantInfo={merchant_id:"",name:"",intro:"",detail:"",img:"",imgs:[],total_price:"",reduced_price:"",on_shelf:"",repertory:"",id:"",sales:0},e.$refs.upload&&e.$refs.upload.clearFiles()},merchantChange:function(e){var t=this;t.merchantInfo.merchant_id=e},stateChange:function(e){var t=this;t.merchantInfo.on_shelf=e},newMerchants:function(){var e=this;console.log(e.merchantInfo),i["a"].createGoods(e.merchantInfo).then((function(t){e.$message.success("添加成功"),e.dialogMerchants=!1,e.merchantInfo={merchant_id:"",name:"",intro:"",detail:"",img:"",imgs:[],total_price:"",reduced_price:"",on_shelf:"",repertory:"",id:"",sales:0},e.getList()}))},beforeUpload:function(){n=this.$loading({lock:!0,text:"图片上传中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},quillImgSuccess:function(e,t){var a=this.$refs.myQuillEditor.quill;if(n.close(),e.data){var l=a.getSelection().index;a.insertEmbed(l,"image",e.data),a.setSelection(l+1)}else this.$message.error("图片插入失败")},handleRemove:function(e,t){var a=this;a.files=t,a.merchantInfo.img=""},beforeAvatarUpload:function(e){var t=307200;return t||this.$message.error("上传图片大小不能超过300KB"),t},handleAvatarSuccess:function(e,t){var a=this;a.merchantInfo.img=t.response.data},handleExceed:function(e,t){var a=this;a.$message.error("上传图片不能超过1张!")},handleChange:function(e,t){var a=this;a.files=t},handleRemove1:function(e,t){var a=this;console.log(e),a.fileLists=t,a.merchantInfo.imgs.splice(a.merchantInfo.imgs.indexOf(e.url),1),console.log(a.merchantInfo.imgs),a.hasNewImage1=!1},beforeAvatarUpload1:function(e){this.fileLists.length>9&&this.$message.error("最多只能上传9张图片");var t=e.size/1024<500;return t||this.$message.error("上传产品图片大小不能超过 500K!"),t&&this.fileLists.length<=9},handleAvatarSuccess1:function(e,t){var a=this;a.merchantInfo.imgs.push(t.response.data)},handleExceed1:function(e,t){var a=this;a.$message.error("上传图片不能超过9张!")},handleChange1:function(e,t){var a=this;a.fileLists=t},handleDetail:function(e,t){var a=this;a.dialogMerchants=!0,a.id=t.id,i["a"].goodsDetails(a.id).then((function(e){a.merchantInfo={merchant_id:e.merchant_id,name:e.name,intro:e.intro,detail:e.detail,img:e.img,imgs:e.imgs,total_price:e.total_price,reduced_price:e.reduced_price,on_shelf:e.on_shelf,repertory:e.repertory,id:e.id,sales:e.sales},a.fileLists=a.merchantInfo.imgs.map((function(e){var t={};return t.url=e,t}));var t=a.merchantInfo.img.split(",");t.forEach((function(e){var t=new Object;t.url=e,a.files.push(t)}))}))},close:function(){var e=this;e.fileLists=[],e.files=[]}}}),c=s,d=(a("bb4a"),a("2877")),u=Object(d["a"])(c,l,o,!1,null,"766c9e57",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-471ed41a.1954686f.js.map